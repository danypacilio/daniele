<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <!-- Il titolo potrebbe essere impostato dinamicamente da JS -->
    <title>Compilazione Esame Clinico</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Link allo stile CSS principale dell'admin -->
    <link rel="stylesheet" href="admin/style.css" />
    <!-- Link a Bootstrap Icons (se _header non viene incluso) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- Stili specifici per esame.html -->
    <style>
        /* Importa font se non già globale */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body { background-color: var(--light-gray, #f8f9fa); font-family: 'Inter', sans-serif; color: var(--text-dark, #212529); font-size: 15px; line-height: 1.6;}
        .exam-form-container {
            max-width: 900px; margin: 20px auto; background-color: var(--white, #fff);
            padding: 30px 40px; border-radius: var(--border-radius, 8px);
            box-shadow: var(--box-shadow, 0 4px 12px rgba(0,0,0,0.07));
            border: 1px solid var(--dark-gray, #d1d9e1);
        }
        h2, h3 { text-align: center; color: #0056b3; margin-top: 35px; margin-bottom: 20px; }
        h2 { font-size: 1.8em; font-weight: 600; }
        h3 { font-size: 1.3em; font-weight: 600; border-bottom: 1px solid var(--medium-gray, #eef1f4); padding-bottom: 8px; display: flex; align-items: center; justify-content: center; gap: 10px;}
        h3 .icon { font-size: 1.2em; color: var(--primary-color, #4A90E2); } /* Icona nei titoli H3 */
        .section { margin-bottom: 35px; padding-bottom: 25px; border-bottom: 1px dashed var(--dark-gray, #d1d9e1); }
        .section:last-of-type { border-bottom: none; margin-bottom: 0;} /* Rimuovi bordo/margine ultimo */

        label { font-weight: 600; display: block; margin-bottom: 8px; color: var(--text-medium, #5a6268); font-size: 0.95em; }
        input[type="date"], textarea, input[type="number"], select { width: 100%; padding: 10px 12px; margin-bottom: 5px; border: 1px solid var(--dark-gray, #d1d9e1); border-radius: var(--border-radius, 6px); box-sizing: border-box; font-size: 1em; font-family: inherit; }
        input:focus, textarea:focus, select:focus { border-color: var(--primary-color, #4A90E2); outline: none; box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.25); }
        textarea { min-height: 100px; resize: vertical; }
        small { font-size: 0.85em; color: var(--text-light, #88929b); margin-top: 3px; display: block;}

        /* Stili Camera */
        #preview { text-align:center; margin-bottom:20px; border: 1px solid var(--medium-gray); padding: 15px; border-radius: var(--border-radius);}
        #preview video { border: 2px dashed var(--primary-color, #4A90E2); margin-bottom: 15px; display: block; margin-left: auto; margin-right: auto; max-width: 100%;}
        #scattaBtn { /* Usa classi button */ margin-top: 0;}
        .foto-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; justify-items: center; }
        .foto-grid img { max-width: 100%; height: auto; max-height: 250px; border: 1px solid var(--dark-gray, #d1d9e1); border-radius: 4px; background-color: var(--medium-gray, #eef1f4); min-height: 100px; }
        #canvasShot { display: none; }

        /* Checkbox e Radio */
        .checkbox-group, .radio-group { display: flex; flex-wrap: wrap; gap: 10px 20px; padding: 10px 0;}
        .checkbox-group label, .radio-group label { display: inline-flex; align-items: center; margin: 0; font-weight: normal; font-size: 0.95em; cursor: pointer;}
        .radio-group label input[type="radio"], .checkbox-group label input[type="checkbox"] { margin-right: 6px; cursor: pointer; width: auto; margin-bottom: 0;} /* Stile input */

        /* Tabelle */
        table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 0.9em; } th, td { padding: 8px; text-align: center; border: 1px solid var(--dark-gray, #d1d9e1); vertical-align: middle; } th { background-color: var(--medium-gray, #eef1f4); font-weight: 600; color: var(--text-medium);}
        .pgic-table td:first-child { text-align: left; font-weight: 500;} /* Etichetta PGIC */

        /* Punteggi e Riepilogo */
        .score-display { font-weight: bold; display: inline-block; min-width: 35px; text-align: right; padding: 3px 6px; border: 1px solid var(--dark-gray, #d1d9e1); background-color: var(--medium-gray, #eef1f4); margin-left: 5px; border-radius: 3px; font-size: 0.9em;}
        .punteggi-finali { width: 70%; max-width: 450px; margin: 30px auto; padding: 20px; border: 1px solid var(--dark-gray, #d1d9e1); border-radius: var(--border-radius); background-color: #f0f7ff; /* Azzurrino più chiaro */ text-align: center; font-size: 1.05em; line-height: 1.7; }
        .punteggi-finali h3 { margin-top: 0; margin-bottom: 15px; color:#004085; font-size: 1.2em;}
        .punteggi-finali div { margin-bottom: 5px;}

        /* Bottoni (usa classi definite in style.css) */
        .centered-button-container { text-align: center; margin: 40px 0 20px 0; }
        #salvaBtn { font-size: 1.1em; padding: 12px 30px;}

        /* Sottotitolo */
        .subtitle { text-align: center; font-style: italic; color: var(--text-light, #88929b); margin-top: -15px; margin-bottom: 15px; font-size: 0.9em; }

    </style>
</head>
<body>
  <div class="exam-form-container"> <!-- Cambiato nome classe container -->

    <!-- Header Immagine (Opzionale) -->
    <!-- <img src="header.jpg" alt="Header Studio" style="width:100%; margin-bottom:30px;" /> -->

    <h2>Compilazione Esame Clinico</h2>

    <div class="section">
      <p style="font-size: 1.1em;"><strong>Paziente:</strong> <span id="nomeCompleto" style="color: var(--primary-color, #4A90E2);">Caricamento...</span></p>
      <label for="dataEsame">Data Esame *</label>
      <input type="date" id="dataEsame" required />
    </div>

    <div class="section">
      <h3><span class="icon"><i class="bi bi-camera-fill"></i></span> Podografia</h3>
      <div id="preview" style="text-align:center;">
        <video id="videoCam" width="400" height="300" autoplay playsinline style="background:#eee; border-radius: 4px;"></video><br>
        <button id="scattaBtn" type="button" class="button button-success"><i class="bi bi-camera"></i> Scatta Foto</button>
      </div>
      <canvas id="canvasShot" width="400" height="300"></canvas> <!-- Canvas nascosto -->
      <div class="foto-grid">
        <img id="img1" alt="Foto 1" /> <img id="img2" alt="Foto 2 (90°)" />
        <img id="img3" alt="Foto 3 (180°)" /> <img id="img4" alt="Foto 4 (270°)" />
      </div>
    </div>

    <!-- SEZIONE NOTE PODOGRAFIA con Select -->
    <div class="section">
        <h3><span class="icon"><i class="bi bi-journal-richtext"></i></span> Note Podografia</h3>
        <textarea id="notePodografia" name="notePodografia" rows="5" placeholder="Descrivere le osservazioni...">Alla podografia si evidenzia </textarea>
    </div>

    <div class="section">
      <h3><span class="icon"><i class="bi bi-check-circle"></i></span> Esame Obiettivo Podologico</h3>
      <div class="checkbox-group">
        <label><input type="checkbox" name="obiettivo" value="Onicomicosi"> Onicomicosi</label>
        <label><input type="checkbox" name="obiettivo" value="Onicodistrofia"> Onicodistrofia</label>
        <label><input type="checkbox" name="obiettivo" value="Alluce valgo"> Alluce valgo</label>
        <label><input type="checkbox" name="obiettivo" value="Macerazione interdigitale"> Macerazione interdigitale</label>
        <label><input type="checkbox" name="obiettivo" value="Onicocriptosi"> Onicocriptosi</label>
        <label><input type="checkbox" name="obiettivo" value="Retrazione delle dita"> Retrazione dita</label>
      </div>
    </div>

    <div class="section">
      <h3><span class="icon"><i class="bi bi-pin-map-fill"></i></span> Localizzazione Ipercheratosi</h3>
      <div class="checkbox-group">
        <label><input type="checkbox" name="ipercheratosi" value="Dorso delle dita"> Dorso dita</label>
        <label><input type="checkbox" name="ipercheratosi" value="Teste metatarsali"> Teste metatarsali</label>
        <label><input type="checkbox" name="ipercheratosi" value="Tallone"> Tallone</label>
        <label><input type="checkbox" name="ipercheratosi" value="Superficie plantare alluce"> Sup. plant. alluce</label>
        <label><input type="checkbox" name="ipercheratosi" value="Interdigitali"> Interdigitali</label>
      </div>
    </div>

    <div class="section">
      <h3><span class="icon"><i class="bi bi-bandaid-fill"></i></span> Localizzazione delle Ulcere</h3>
      <div style="text-align: center;">
        <img src="centro.jpg" alt="Schema localizzazione ulcere" style="max-width: 600px; width: 100%; border: 1px solid #eee;">
      </div>
    </div>

    <div class="section">
      <h3><span class="icon"><i class="bi bi-clipboard2-pulse-fill"></i></span> Altre Patologie Podologiche</h3>
      <textarea id="altrePatologie" rows="3" placeholder="Descrivere eventuali altre patologie..."></textarea>
    </div>

    <div class="section">
      <h3><span class="icon"><i class="bi bi-soundwave"></i></span> Prove di Sensibilità Vibratoria</h3>
      <p class="subtitle">(Esame eseguito mediante Biotesiometer)</p>
      <table class="vibratoria-table">
         <thead> <tr><th>Punti di Repere</th><th>Piede Destro</th><th>Piede Sinistro</th></tr> </thead>
         <tbody> <!-- ... righe tabella vibrazioni ... -->
           <tr><td>Malleolo</td><td><input type="number" name="vib_malleolo_dx" min="0"></td><td><input type="number" name="vib_malleolo_sx" min="0"></td></tr>
           <tr><td>Alluce</td><td><input type="number" name="vib_alluce_dx" min="0"></td><td><input type="number" name="vib_alluce_sx" min="0"></td></tr>
           <tr><td>V Dito</td><td><input type="number" name="vib_5dito_dx" min="0"></td><td><input type="number" name="vib_5dito_sx" min="0"></td></tr>
           <tr><td>I Metatarso</td><td><input type="number" name="vib_1meta_dx" min="0"></td><td><input type="number" name="vib_1meta_sx" min="0"></td></tr>
           <tr><td>V Metatarso</td><td><input type="number" name="vib_5meta_dx" min="0"></td><td><input type="number" name="vib_5meta_sx" min="0"></td></tr>
           <tr><td>Mesopiede</td><td><input type="number" name="vib_meso_dx" min="0"></td><td><input type="number" name="vib_meso_sx" min="0"></td></tr>
           <tr><td>Calcagno</td><td><input type="number" name="vib_calcagno_dx" min="0"></td><td><input type="number" name="vib_calcagno_sx" min="0"></td></tr>
        </tbody>
      </table>
      <p class="italic-ref">Valore di riferimento < 25</p>
    </div>

    <div class="section">
        <h3><span class="icon"><i class="bi bi-chat-left-text-fill"></i></span> Osservazioni</h3>
        <textarea id="osservazioni" rows="3" placeholder="Note aggiuntive, osservazioni cliniche..."></textarea>
    </div>

    <div class="section">
        <h3><span class="icon"><i class="bi bi-list-check"></i></span> Questionario DN4</h3>
        <ol id="dn4"> <!-- ... (righe da 1 a 10 con radio SI/NO e label migliorate) ... -->
             <h4>DOMANDA 1: Il dolore presenta una o più delle seguenti caratteristiche</h4>
			 <li>Bruciante/Urgente: <span class="radio-group"><label><input type="radio" name="dn4_1" value="SI">SI</label> <label><input type="radio" name="dn4_1" value="NO" checked>NO</label></span></li>
             <li>Freddo doloroso: <span class="radio-group"><label><input type="radio" name="dn4_2" value="SI">SI</label> <label><input type="radio" name="dn4_2" value="NO" checked>NO</label></span></li>
             <li>Scariche elettriche: <span class="radio-group"><label><input type="radio" name="dn4_3" value="SI">SI</label> <label><input type="radio" name="dn4_3" value="NO" checked>NO</label></span></li>
             <h4>DOMANDA 2: Il dolore è associato, nella stessa area, ad uno o più dei seguenti sintomi?</h4>
			 <li>Formicolio: <span class="radio-group"><label><input type="radio" name="dn4_4" value="SI">SI</label> <label><input type="radio" name="dn4_4" value="NO" checked>NO</label></span></li>
             <li>Punture di spillo: <span class="radio-group"><label><input type="radio" name="dn4_5" value="SI">SI</label> <label><input type="radio" name="dn4_5" value="NO" checked>NO</label></span></li>
             <li>Intorpidimento: <span class="radio-group"><label><input type="radio" name="dn4_6" value="SI">SI</label> <label><input type="radio" name="dn4_6" value="NO" checked>NO</label></span></li>
             <li>Prurito: <span class="radio-group"><label><input type="radio" name="dn4_7" value="SI">SI</label> <label><input type="radio" name="dn4_7" value="NO" checked>NO</label></span></li>
             <h4>DOMANDA 3: Il dolore è localizzato in un territorio dove l’esame obiettivo evidenzia:</h4>        
			 <li>Ipoestesia al tatto: <span class="radio-group"><label><input type="radio" name="dn4_8" value="SI">SI</label> <label><input type="radio" name="dn4_8" value="NO" checked>NO</label></span></li>
             <li>Ipoestesia alla puntura: <span class="radio-group"><label><input type="radio" name="dn4_9" value="SI">SI</label> <label><input type="radio" name="dn4_9" value="NO" checked>NO</label></span></li>
             <h4>DOMANDA 4: Il dolore è provocato o accentuato dallo:</h4>        
			 <li>Sfioramento della pelle: <span class="radio-group"><label><input type="radio" name="dn4_10" value="SI">SI</label> <label><input type="radio" name="dn4_10" value="NO" checked>NO</label></span></li>
        </ol>
        <p style="text-align: right;"><strong>Punteggio DN4:</strong> <span id="dn4ScoreDisplay" class="score-display">0</span> / 10</p>
    </div>

    <div class="section">
        <h3><span class="icon"><i class="bi bi-bar-chart-steps"></i></span> Scala NRS del Dolore</h3>
        <p class="subtitle">(Scala Unidimensionale 0-10)</p>
        <div id="nrsContainer" class="radio-group" style="text-align: center;"> <!-- ... (radio da 0 a 10) ... -->
             <label><input type="radio" name="nrs" value="0"> 0</label> <label><input type="radio" name="nrs" value="1"> 1</label> <label><input type="radio" name="nrs" value="2"> 2</label> <label><input type="radio" name="nrs" value="3"> 3</label> <label><input type="radio" name="nrs" value="4"> 4</label> <label><input type="radio" name="nrs" value="5"> 5</label> <label><input type="radio" name="nrs" value="6"> 6</label> <label><input type="radio" name="nrs" value="7"> 7</label> <label><input type="radio" name="nrs" value="8"> 8</label> <label><input type="radio" name="nrs" value="9"> 9</label> <label><input type="radio" name="nrs" value="10"> 10</label>
        </div>
        <p style="text-align: right;"><strong>Valore NRS Selezionato:</strong> <span id="nrsScoreDisplay" class="score-display">N/D</span></p>
    </div>

    <div class="section">
        <h3><span class="icon"><i class="bi bi-clipboard-data-fill"></i></span> Valutazione PGIC</h3>
        <p class="subtitle">Cambiamento percepito dal paziente rispetto all'inizio del trattamento</p>
        <table class="pgic-table"> <!-- ... (tabella PGIC come prima) ... -->
             <thead><tr><th>PGIC</th><th>Attività Fisica</th><th>Sintomi</th><th>Emozioni</th><th>Qualità Vita</th></tr></thead>
             <tbody> <tr><td>7 - Peggioramento Notevole</td><td><input type="radio" name="pgic_fisica" value="7"></td><td><input type="radio" name="pgic_sintomi" value="7"></td><td><input type="radio" name="pgic_emozioni" value="7"></td><td><input type="radio" name="pgic_vita" value="7"></td></tr> <tr><td>6 - Nessun Cambiamento</td><td><input type="radio" name="pgic_fisica" value="6" checked></td><td><input type="radio" name="pgic_sintomi" value="6" checked></td><td><input type="radio" name="pgic_emozioni" value="6" checked></td><td><input type="radio" name="pgic_vita" value="6" checked></td></tr> <tr><td>5 - Miglioramento Minimo</td><td><input type="radio" name="pgic_fisica" value="5"></td><td><input type="radio" name="pgic_sintomi" value="5"></td><td><input type="radio" name="pgic_emozioni" value="5"></td><td><input type="radio" name="pgic_vita" value="5"></td></tr> <tr><td>4 - Miglioramento Lieve</td><td><input type="radio" name="pgic_fisica" value="4"></td><td><input type="radio" name="pgic_sintomi" value="4"></td><td><input type="radio" name="pgic_emozioni" value="4"></td><td><input type="radio" name="pgic_vita" value="4"></td></tr> <tr><td>3 - Miglioramento Moderato</td><td><input type="radio" name="pgic_fisica" value="3"></td><td><input type="radio" name="pgic_sintomi" value="3"></td><td><input type="radio" name="pgic_emozioni" value="3"></td><td><input type="radio" name="pgic_vita" value="3"></td></tr> <tr><td>2 - Miglioramento Buono</td><td><input type="radio" name="pgic_fisica" value="2"></td><td><input type="radio" name="pgic_sintomi" value="2"></td><td><input type="radio" name="pgic_emozioni" value="2"></td><td><input type="radio" name="pgic_vita" value="2"></td></tr> <tr><td>1 - Miglioramento Ottimo</td><td><input type="radio" name="pgic_fisica" value="1"></td><td><input type="radio" name="pgic_sintomi" value="1"></td><td><input type="radio" name="pgic_emozioni" value="1"></td><td><input type="radio" name="pgic_vita" value="1"></td></tr> </tbody>
        </table>
        <p style="text-align: right;"><strong>Punteggio PGIC Totale:</strong> <span id="pgicScoreDisplay" class="score-display">24</span> / 28</p>
    </div>

    <div class="section punteggi-finali">
        <h3><i class="bi bi-calculator-fill"></i> Riepilogo Punteggi</h3>
        <div><strong>DN4:</strong> <span id="dn4ScoreFinal" class="score-display">0</span> / 10</div>
        <div><strong>NRS:</strong> <span id="nrsScoreFinal" class="score-display">N/D</span></div>
        <div><strong>PGIC:</strong> <span id="pgicScoreFinal" class="score-display">24</span> / 28</div>
    </div>

    <div class="section">
        <h3><span class="icon"><i class="bi bi-calendar-check-fill"></i></span> Ripetere lo screening tra:</h3>
        <div class="checkbox-group">
            <label><input type="checkbox" name="screening" value="3 mesi"> 3 mesi</label>
            <label><input type="checkbox" name="screening" value="6 mesi" checked> 6 mesi</label>
            <label><input type="checkbox" name="screening" value="1 anno"> 1 anno</label>
        </div>
    </div>

    <div class="centered-button-container">
      <button type="button" onclick="salvaEsame()" id="salvaBtn" class="button button-info"><i class="bi bi-save-fill"></i> Salva Esame</button>
    </div>

  </div> <!-- Fine container -->

  <!-- Script JS -->
  <script src="script.js"></script>

</body>
</html>